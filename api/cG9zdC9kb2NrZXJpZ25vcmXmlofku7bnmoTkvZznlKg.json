{"title":".dockerignore文件的作用","date":"2018-03-09T20:31:38.000Z","excerpt":"<blockquote>\n<p>英文好的同学建议直接阅读文档：<br><a href=\"https://docs.docker.com/engine/reference/builder/#dockerignore-file\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/reference/builder/#dockerignore-file</a></p>\n</blockquote>","slug":"dockerignore文件的作用","comments":true,"tags":["docker"],"categories":["docker"],"updated":"2018-08-20T10:05:37.942Z","content":"<blockquote>\n<p>英文好的同学建议直接阅读文档：<br><a href=\"https://docs.docker.com/engine/reference/builder/#dockerignore-file\" target=\"_blank\" rel=\"noopener\">https://docs.docker.com/engine/reference/builder/#dockerignore-file</a></p>\n</blockquote>\n<a id=\"more\"></a>\n<h1 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h1><p>在项目中，我们见过很多各式各样的 <code>ignore</code> 文件。</p>\n<p>比如使用  <code>.gitignore</code> 来忽略掉你不想追踪的文件：</p>\n<p><a href=\"https://git-scm.com/docs/gitignore\" target=\"_blank\" rel=\"noopener\">https://git-scm.com/docs/gitignore</a></p>\n<p>使用 <code>.npmignore</code> 来忽略你在发布包时不想发布的文件：</p>\n<p><a href=\"https://docs.npmjs.com/misc/developers#keeping-files-out-of-your-package\" target=\"_blank\" rel=\"noopener\">https://docs.npmjs.com/misc/developers#keeping-files-out-of-your-package</a></p>\n<h1 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h1><p>那么 <code>.dockerignore</code> 文件是起什么作用的呢？</p>\n<p>不管是在 <code>docker build</code> 过程中，还是 <code>docker run</code> 的过程中，有没有这个文件好像并没有什么很大的影响，存在感不强的一个文件。</p>\n<p>首先需要理解一下 <code>镜像构建上下文(context)</code> 的概念，参见另一篇博文：</p>\n<p><a href=\"http://blog.csdn.net/xs20691718/article/details/79502019\" target=\"_blank\" rel=\"noopener\">docker build 命令后 . 号的意思</a></p>\n<p>理解了这个概念就明白，当我们在 <code>docker build</code> 的过程中，首先会将指定的上下文目录打包传递给 <code>docker引擎</code>，而这个上下文目录中可能并不是所有的文件我们都会在 <code>Dockerfile</code> 中使用到，那么这个时候就可以在 <code>.dockerignore</code> 文件中指定在传递给 <code>docker引擎</code> 时需要忽略掉的文件或文件夹。</p>\n<h3 id=\"举栗说明～\"><a href=\"#举栗说明～\" class=\"headerlink\" title=\"举栗说明～\"></a>举栗说明～</h3><p>比如我们在前端项目中，<code>node_modules</code> 文件夹在构建镜像过程中如果用不到，但是又异常庞大，那么向 <code>docker引擎</code> 传递其实是并没有必要的（其实大家电脑性能都这么好，也不在乎这几秒钟了。。。只是举个例子，可以提升镜像构建速度），这个时候就可以将 <code>node_modules</code> 文件夹加入 <code>.dockerignore</code> 文件中。</p>\n<p>如下所示，速度提升还是很明显的。</p>\n<p><strong>加入前：</strong><br><img src=\"/assets/images/.dockerignore文件的作用/before.gif\" alt=\"这里写图片描述\"></p>\n<p><strong>加入后：</strong><br><img src=\"/assets/images/.dockerignore文件的作用/after.gif\" alt=\"这里写图片描述\"></p>\n","prev":{"title":"防止私有npm包误发布","slug":"防止私有npm包误发布"},"next":{"title":"2017半载小记","slug":"2017半载小记"},"link":"/post/dockerignore文件的作用","toc":[{"title":"背景","id":"背景","index":"1"},{"title":"问题","id":"问题","index":"2"}]}