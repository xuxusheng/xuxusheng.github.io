{"title":"防止私有npm包误发布","date":"2018-07-12T17:42:44.000Z","author":"许盛","excerpt":"<blockquote>\n<p>某年某月某日，发生了一起 npm publish 事故，项目代码被直接 publish 到 npm 官方仓库里去了。<br>发布 24 小时以内的包，可以通过 <code>npm unpublish</code> 命令取消发布，参见 <a href=\"https://docs.npmjs.com/cli/unpublish。\" target=\"_blank\" rel=\"noopener\">https://docs.npmjs.com/cli/unpublish。</a><br>本以为这样应该就没事了，结果小瞧了淘宝源每十分钟同步一次的速度，被同步到淘宝源上去了。。。</p>\n</blockquote>\n<p>那么如何避免这种误发布的情况呢?</p>","slug":"防止私有npm包误发布","comments":true,"tags":["npm","node.js"],"categories":["npm"],"updated":"2018-08-20T09:46:27.476Z","content":"<blockquote>\n<p>某年某月某日，发生了一起 npm publish 事故，项目代码被直接 publish 到 npm 官方仓库里去了。<br>发布 24 小时以内的包，可以通过 <code>npm unpublish</code> 命令取消发布，参见 <a href=\"https://docs.npmjs.com/cli/unpublish。\" target=\"_blank\" rel=\"noopener\">https://docs.npmjs.com/cli/unpublish。</a><br>本以为这样应该就没事了，结果小瞧了淘宝源每十分钟同步一次的速度，被同步到淘宝源上去了。。。</p>\n</blockquote>\n<p>那么如何避免这种误发布的情况呢?</p>\n<a id=\"more\"></a>\n<h2 id=\"一、-npmignore-文件\"><a href=\"#一、-npmignore-文件\" class=\"headerlink\" title=\"一、.npmignore 文件\"></a>一、.npmignore 文件</h2><p>首先想到的是通过 <code>.npmignore</code> 将敏感文件给排除掉，这样就算不小心 <code>publish</code> 了，也只会发布一些无关紧要的通用文件。 </p>\n<p>于是在脚手架的模版代码中加入了 <code>.npmignore</code> 文件，一开始以为 <code>.npmignore</code> 文件只有放在根目录下才对当前项目生效。。。结果发现就算不放在根目录，也会生效，导致脚手架发布出问题了。。。</p>\n<h2 id=\"二、package-json-中-private-字段\"><a href=\"#二、package-json-中-private-字段\" class=\"headerlink\" title=\"二、package.json 中 private 字段\"></a>二、package.json 中 private 字段</h2><p>今天突然在 <code>webpack</code> 的文档中发现了这么一段（以前不记得有看到过啊。。。）：</p>\n<p><img src=\"/assets/images/防止私有npm包误发布/webpack.png\" alt=\"这里写图片描述\"></p>\n<p>通过翻阅 <code>package.json</code> 的 <code>schema</code> 文件：</p>\n<p><img src=\"/assets/images/防止私有npm包误发布/schema.png\" alt=\"这里写图片描述\"></p>\n<p>相关官方文档参见： <a href=\"https://docs.npmjs.com/files/package.json#license\" target=\"_blank\" rel=\"noopener\">https://docs.npmjs.com/files/package.json#license</a></p>\n<p><img src=\"/assets/images/防止私有npm包误发布/doc.png\" alt=\"这里写图片描述\"></p>\n","prev":{"title":"hexo主题之inside","slug":"hexo主题之inside"},"next":{"title":"2017半载小记","slug":"2017半载小记"},"link":"/post/防止私有npm包误发布","toc":[{"title":"一、.npmignore 文件","id":"一、-npmignore-文件","index":"1"},{"title":"二、package.json 中 private 字段","id":"二、package-json-中-private-字段","index":"2"}]}